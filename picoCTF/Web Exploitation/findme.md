<img width="1409" height="357" alt="image" src="https://github.com/user-attachments/assets/8c186dfe-3ded-487e-be49-971284b09435" />
<img width="1242" height="305" alt="image" src="https://github.com/user-attachments/assets/1673b4b8-98fa-4161-9bce-9ebc4861c51c" />
<img width="1203" height="280" alt="image" src="https://github.com/user-attachments/assets/c5b3962b-705b-4bc5-a668-696f044c099b" />

# FindMe - CTF Challenge Writeup

**Author:** Geoffrey Njogu  
**Category:** Web Exploitation  
**Difficulty:** Medium  
**Points:** [Points value]  

## Challenge Description

> Help us test the form by submitting the username as `test` and password as `test!`

## Initial Analysis

Upon accessing the challenge, we're presented with two main components:

### 1. Bank Search Interface
```html
<!DOCTYPE html>
<html lang=en>
  <head>
    <title>Our Bank</title>
    <!-- Search functionality for "flags" -->
    <script>
      function search() {
        // JavaScript shows UI changes but server communication is commented
        // "fetching results related to the keyword value from the server"
      }
    </script>
  </head>
  <body>
    <form id="search-form" onsubmit="return search()">
      <input id="keyword" type="text" placeholder="Search for flags">
    </form>
    <p>I was redirected here by a friend of mine but i couldnt find anything. Help me search for flags :-)</p>
  </body>
</html>
```

### 2. Login Form
```html
<form class="form-signin" action="/login" method="post">
  <label for="username">Username</label>
  <input type="text" id="username" name="username" placeholder="username" required autofocus />
  <label for="password">Password</label>
  <input type="password" id="password" name="password" placeholder="Password" required />
  <input type="submit" id="loginForm" class="btn btn-success" value="test" />
</form>
```

### Key Observations

1. **Hardcoded credentials provided:** `test` / `test!`
2. **Search interface mentions "flags"** - potential red herring or hint
3. **HTML comment about "redirected by a friend"** - suggests redirect chains
4. **Server URL:** `saturn.picoctf.net:52184`

## Solution Approach

Given the hint about redirections and the challenge name "findme", I suspected the flag might be hidden in HTTP redirect responses that browsers automatically follow.

### Tools Required
- **Burp Suite** (or similar proxy tool)
- **Base64 decoder**
- **Browser with Developer Tools**

## Step-by-Step Solution

### Step 1: Setup Burp Suite
1. Configure browser to proxy through Burp Suite (127.0.0.1:8080)
2. Enable **Intercept** mode in Burp's Proxy tab
3. Navigate to the challenge URL

### Step 2: Submit Login Credentials
Submit the form with the provided credentials:
- Username: `test`
- Password: `test!` (note the exclamation mark)

**Request intercepted:**
```http
POST /login HTTP/1.1
Host: saturn.picoctf.net:52184
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

username=test&password=test%21
```

### Step 3: Follow the Redirect Chain

**First Redirect Response:**
```http
HTTP/1.1 302 Found
Location: /next-page/id=bF90aGVfd2F5X2QxYzBiMTEyfQ==
```

Forward the request in Burp Suite to trigger the first redirect.

**Second Request:**
```http
GET /next-page/id=bF90aGVfd2F5X2QxYzBiMTEyfQ== HTTP/1.1
Host: saturn.picoctf.net:52184
Referer: http://saturn.picoctf.net:52184/
```

**Second Redirect Response:**
```http
HTTP/1.1 302 Found
Location: /next-page/id=cGljb0NURntwcm94aWVzX2Fs
```

**Third Request:**
```http
GET /next-page/id=cGljb0NURntwcm94aWVzX2Fs HTTP/1.1
Host: saturn.picoctf.net:52184
Referer: http://saturn.picoctf.net:52184/next-page/id=cGljb0NURntwcm94aWVzX2Fs
```

### Step 4: Extract and Decode Base64 Data

I noticed both redirect URLs contain base64-encoded data in the `id` parameter:

**First base64 string:** `cGljb0NURntwcm94aWVzX2Fs`
```bash
$ echo "cGljb0NURntwcm94aWVzX2Fs" | base64 -d
picoCTF{proxies_al
```

**Second base64 string:** `bF90aGVfd2F5X2QxYzBiMTEyfQ==`
```bash
$ echo "bF90aGVfd2F5X2QxYzBiMTEyfQ==" | base64 -d
l_the_way_d1c0b112}
```

### Step 5: Reconstruct the Flag

Combining both decoded parts:
- Part 1: `picoCTF{proxies_al`
- Part 2: `l_the_way_d1c0b112}`

**Complete Flag:** `picoCTF{proxies_all_the_way_d1c0b112}`

## Technical Analysis

### Why This Attack Works

1. **Automatic Redirect Following:** Modern browsers automatically follow HTTP redirects (301, 302, 307, 308), hiding intermediate responses from users
2. **Information Leakage:** Sensitive data can be embedded in redirect URLs, headers, or cookies during the redirect chain
3. **Base64 Obfuscation:** The flag was split and base64-encoded across multiple redirect steps to avoid easy detection

### Redirect Chain Visualization

```
[Login Form] 
     ↓ POST /login (credentials)
[302 Redirect] → /next-page/id=bF90aGVfd2F5X2QxYzBiMTEyfQ==
     ↓ GET (first redirect)
[302 Redirect] → /next-page/id=cGljb0NURntwcm94aWVzX2Fs  
     ↓ GET (second redirect)
[Final Page] → 200 OK
```

### Security Implications

This challenge demonstrates several real-world vulnerabilities:

1. **Information Disclosure:** Sensitive data leaked in redirect URLs
2. **Session Management Issues:** Poor handling of authentication flows
3. **Client-Side Security Assumptions:** Relying on browsers to hide intermediate steps

## Alternative Solution Methods

### Method 1: curl with verbose output
```bash
curl -L -v -X POST \
  -d "username=test&password=test!" \
  http://saturn.picoctf.net:52184/login
```

### Method 2: Python Script
```python
import requests
import base64

session = requests.Session()
session.max_redirects = 0

# Login request
login_data = {'username': 'test', 'password': 'test!'}
response = session.post('http://saturn.picoctf.net:52184/login', 
                       data=login_data, allow_redirects=False)

flag_parts = []
current_url = response.headers.get('Location')

# Follow redirect chain manually
for i in range(5):
    if not current_url:
        break
        
    response = session.get(f'http://saturn.picoctf.net:52184{current_url}', 
                          allow_redirects=False)
    
    # Extract base64 from URL
    if 'id=' in current_url:
        b64_data = current_url.split('id=')[1]
        try:
            decoded = base64.b64decode(b64_data).decode()
            flag_parts.append(decoded)
        except:
            pass
    
    current_url = response.headers.get('Location')

print(''.join(flag_parts))
```

### Method 3: Browser Developer Tools
1. Open Network tab (F12)
2. Submit login form
3. Look for 302 status codes in request list
4. Examine redirect URLs for base64 data

## Key Learning Points

1. **Always inspect redirect chains** when dealing with web applications
2. **Use proxy tools** like Burp Suite for comprehensive request/response analysis  
3. **Base64 encoding is common** for data obfuscation in CTFs
4. **Browsers hide important information** through automatic redirect following
5. **Challenge names and descriptions** often contain crucial hints

## Preventive Measures

To prevent similar vulnerabilities in production:

1. **Never include sensitive data in URLs** - use session storage instead
2. **Implement proper session management** with secure tokens
3. **Minimize redirect chains** - use direct routing where possible
4. **Log and monitor redirect patterns** for suspicious activity
5. **Use HTTPS** to encrypt redirect URLs in transit

## Flag

`picoCTF{proxies_all_the_way_d1c0b112}`

---

**Writeup by:** [Your Name]  
**Date:** [Current Date]  
**Tools Used:** Burp Suite, base64, curl  
**Time Taken:** ~15 minutes
