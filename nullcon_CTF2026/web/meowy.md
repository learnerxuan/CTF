---
ctf: NullconCTF 2026
category: web
difficulty: hard
points: 450
flag: ENO{werkzeug_debugger_bypass}
techniques:
  - flask-secret-bruteforce
  - ssrf-gopher
  - werkzeug-debugger-pin-bypass
tools:
  - python
  - burp-suite
---

# Meowy

## Description

The service is a Flask cat gallery with an admin-only `/fetch` feature. The server runs with Werkzeug's debugger enabled.

**Goal:** retrieve `ENO{...}` from the server

## Solution

### 1. Forge Admin Session Cookie

**Weak Flask `secret_key`:**

- The app sets `app.secret_key` to a single random word generated by `random_word.RandomWords()`
- `random_word` defaults to the Local backend and chooses a random key from its bundled `words.json`
- Because we can obtain a valid Flask session cookie from `/` (`{"is_admin": false}`), we **brute-force the secret key** offline by trying all `words.json` keys with length â‰¥ 12 until `itsdangerous` verifies the cookie signature
- With the cracked secret key we sign a new cookie with `{"is_admin": true}` and access `/fetch`

### 2. Use /fetch for File Read and Internal SSRF

- `/fetch` uses `pycurl` and allows fetching `file://` URLs (arbitrary file read as the web user)
- Listing `file:///` reveals `/flag.txt` exists but is not readable by the web user, and `/readflag` exists as an executable that can output the flag
- `/fetch` can also reach internal services. External port 5004 maps to internal 5000, so `http://127.0.0.1:5000/console` is reachable

### 3. Bypass Werkzeug Debugger PIN Trust

**Challenge:** Werkzeug's debugger requires a "trusted" cookie (`__wzd...`) that normally gets set by `cmd=pinauth`. The app blocks `cmd=pinauth`, so we can't unlock through the normal endpoint.

**Solution:**

1. Compute the correct debugger trust cookie name and value (Werkzeug's `get_pin_and_cookie_name` + `hash_pin`) using data we can read via `/fetch`:
   - `/etc/machine-id`
   - `/sys/class/net/eth0/address`
   - `/etc/passwd`

2. Inject that cookie into an internal HTTP request using **`gopher://`** (raw request smuggling) through `/fetch`

3. With the trust cookie present, Werkzeug accepts `__debugger__=yes&cmd=<python>&frm=0&s=<SECRET>` and executes Python in the console frame

4. Execute `os.popen("/readflag").read()` to print the flag

### Exploit Chain

```python
# 1. Bruteforce Flask secret
# 2. Forge admin cookie
# 3. Read /etc/machine-id, /sys/class/net/eth0/address, /etc/passwd via /fetch
# 4. Compute Werkzeug PIN and trust cookie
# 5. Craft gopher:// payload with trust cookie
# 6. Execute Python via /fetch + gopher SSRF
# 7. Extract flag from response
```

## Key Techniques

- Flask session secret bruteforce
- SSRF via gopher protocol
- Werkzeug debugger PIN bypass
- Cookie injection via raw HTTP smuggling

